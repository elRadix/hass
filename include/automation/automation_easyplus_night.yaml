- id: easyplus_6
  initial_state: 'true'
  alias: Auto Easyplus off Notification  Night
  trigger:
    platform: time
    at: '00:25:00'
  condition:
    condition: and
    conditions:
      - condition: state
        entity_id: input_boolean.night
        state: 'on'  
      - condition: state
        entity_id: group.easyplus_lights
        state: 'on'
      - condition: state
        entity_id: switch.easyplus
        state: 'on'
  action:
  - service: notify.dageraad
    data_template:
      title: 'Night Modus will start over 5min'
      message: >
          What shall we do now?
      inline_keyboard:
         - "Shutdown:/night_now"
         - "Delay:/night_delay"
  # - service: notify.dageraad
  #   data:
  #     message: "Auto Shutdown starting in 5min."
  # - service: telegram_bot.send_message
  #   data_template:
  #     title: 'Night Modus'
  #     target: notify.dageraad #1999381 # or '{{ trigger.event.data.user_id }}' # to be test
  #     message: 'Activate or Delay Night Modus'
  #     inline_keyboard:
  #       - "Activate:/night_now"
  #       - "Delay:/night_delay"


- id: easyplus_6_tg_night_now
  initial_state: 'true'
  alias: 'Telegram reply night_now'
  trigger:
  - platform: event
    event_type: telegram_command
    event_data:
      command: '/night_now'
  action:
  - service: script.lights
  - service: script.switches
  - delay:
      seconds: 10
  - service: homeassistant.turn_off
    entity_id: switch.easyplus        
  - service: telegram_bot.send_message
    data_template:
      target: '{{ trigger.event.data.user_id }}'
      message: '

      You have selected Night Modus, House shutdown'


- id: easyplus_6_tg_night_delay
  initial_state: 'true'
  alias: 'Telegram reply night_delay'
  trigger:
  - platform: event
    event_type: telegram_command
    event_data:
      command: '/night_delay'
  action:
  - service: homeassistant.turn_off
    entity_id: input_boolean.night      
  - service: telegram_bot.send_message
    data_template:
      target: '{{ trigger.event.data.user_id }}'
      message: '

      Night has been deactivated'

- id: easyplus_6a
  initial_state: 'true'
  alias: Auto Easyplus Shutdown Lights
  trigger:
    platform: time
    at: '00:30:00'
  condition:
    condition: and
    conditions:
      - condition: state
        entity_id: input_boolean.night
        state: 'on'    
      - condition: state
        entity_id: group.easyplus_lights
        state: 'on'
      - condition: state
        entity_id: switch.easyplus
        state: 'on'
  action:
  - service: script.lights
  - service: notify.dageraad
    data:
      message: "Night Modus, Lights Off"

- id: easyplus_6b
  initial_state: 'true'
  alias: Auto Easyplus Shutdown Switches
  trigger:
    platform: time
    at: '00:30:30'
  condition:
    condition: and
    conditions:
      - condition: state
        entity_id: input_boolean.night
        state: 'on'    
      - condition: state
        entity_id: group.easyplus_switches
        state: 'on'
      - condition: state
        entity_id: switch.easyplus
        state: 'on'
  action:
  - service: script.switches
  - service: notify.dageraad
    data:
      message: "Night Modus, Switches Off"

- id: easyplus_6c
  initial_state: 'true'
  alias: Auto Easyplus Shutdown 
  trigger:
    platform: time
    at: '00:30:55'
  condition:
    condition: and
    conditions:
      - condition: state
        entity_id: input_boolean.night
        state: 'on'    
      - condition: state
        entity_id: switch.easyplus
        state: 'on'
  action:
  - service: homeassistant.turn_off
    entity_id: switch.easyplus
  - service: notify.dageraad
    data:
      message: "Night Modus, Easyplus Off"
###############################################################